<script>
  function crearTablaContactos() {
    let tabla = document.getElementById("tablaContactos");
    if (tabla) { tabla.remove() }
    tabla = document.createElement("table");
    tablaId = tabla.id = "tablaContactos"
    let tablaHeader = document.createElement('thead')
    let cuerpoTabla = document.createElement('tbody');
    google.script.run.withSuccessHandler(function (objeto) {
      // Creamos el cabecero
      let primeraFila = document.createElement('tr')
      // Recorremos la primera fila del objeto(indice 0)
      for (i = 0; i < objeto[0][i]; i++) {
        let celda = document.createElement('th');
        celda.textContent = objeto[0][i];                                       //Asignam os el valor
        primeraFila.appendChild(celda)                                      //Agregamos la celda a la fila  
      }
      tablaHeader.appendChild(primeraFila);
      /*for (i = 0; i < objeto.length; i++) {
        // Creamos fila 
        let fila = document.createElement('tr');
        for (j = 0; objeto[i].length; j++) {
          let celda = document.createElement('td');
          celda.textContent = objeto[i][j];
          //agregamos a la fila
          fila.appendChild(celda);
        }
        if (i == 0) { tableHeader.appendChild(fila) }
        else { cuerpoTabla.appendChild(fila) }
      }*/
      /*    Array.from(objeto).forEach((filaActual, i) => {
            let fila = document.createElement('tr');
            filaActual.forEach(celdaActual => {
              let celda = document.createElement('td');
              window.alert("El dato de la celda es " + celdaActual);
              celda.textContent = celdaActual;
              fila.appendChild(celda);
            })
            if (i == 0) { tablaHeader.appendChild(fila); }
            else { cuerpoTabla.appendChild(fila); }
          });
    */

      tabla.appendChild(tablaHeader);
      tablaHeader.classList.add("table-dark");
      tabla.appendChild(cuerpoTabla);
      tabla.classList.add('table', 'table-striped', 'border', 'border-3', 'table-success')
      document.getElementById('divContactos').appendChild(tabla);

    }).obtenerContactos()
  }

  function agregarElemento() {

    //Creamos una tabla que agregamos la div  div1 
    window.alert("Hola mundo");
    let parrafo = document.createElement('p');
    parrafo.textContent = "Hoja javascript"
    //Creamos la tabla
    let tabla = document.createElement('table');
    let cuerpoTabla = document.createElement('tbody');
    // creamos filas con un bucle for()
    for (let i = 0; i < 4; i++) {

      let fila = document.createElement('tr');
      //Creamos celdas
      for (let j = 0; j < 5; j++) {

        let celda = document.createElement('td');
        celda.textContent = "fila " + i + " Columna " + j;
        //   window.alert(celda.textContent);
        //agregamos la celda a la fila
        fila.appendChild(celda);
        celda.classList.add('border')
      }
      // agregamos la fila al cuerpoTabla
      cuerpoTabla.appendChild(fila);

    }
    //agregamos el cuerpo a la tabla
    tabla.appendChild(cuerpoTabla);
    //agregamos la tabla  al div
    document.getElementById("div1").appendChild(tabla);
    tabla.classList.add('table', 'table-success', 'table-striped', 'border', 'border-3', 'border-danger', 'w-50');
    document.getElementById("div1").appendChild(parrafo)
  }
</script>